(this.webpackJsonpgba_vocc_ts=this.webpackJsonpgba_vocc_ts||[]).push([[0],{21:function(e,t,n){e.exports=n(33)},32:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),o=n(12),c=n.n(o),l=n(3),s=n.n(l),u=n(6),d=n(2),m=n(15),h=n(4),f=n(5),w=function(){function e(t,n,a,r){Object(h.a)(this,e),this.r=void 0,this.g=void 0,this.b=void 0,this.a=void 0,this.r=t,this.g=n,this.b=a,this.a=r}return Object(f.a)(e,[{key:"isEqual",value:function(t){if(t===this)return!0;if(!(t instanceof e))return!1;var n=t;return this.r===n.r&&this.g===n.g&&this.b===n.b&&this.a===n.a}}]),e}();!function(e){e.Bitmap="Bitmap",e.Spritesheet="Spritesheet",e.Background="Background"}(a||(a={}));new w(0,0,0,1),new w(255,0,0,1),new w(0,255,0,1),new w(0,0,255,1);var g,v={height:16,width:16},p=v.height*v.width;!function(e){e[e.PENCIL=0]="PENCIL",e[e.BUCKET=1]="BUCKET",e[e.SQUARE=2]="SQUARE",e[e.ELLIPSE=3]="ELLIPSE",e[e.ZOOM=4]="ZOOM",e[e.PAN=5]="PAN",e[e.DROPPER=6]="DROPPER"}(g||(g={}));var b="imageData",E="palette",x="imageMode",C="imageType",y={grid:!0,currentTool:g.PENCIL,imageMode:3,editorMode:a.Bitmap},O=[new w(0,0,0,1),new w(128,0,0,1),new w(0,128,0,1),new w(128,128,0,1),new w(0,0,128,1),new w(128,0,128,1),new w(0,128,128,1),new w(192,192,192,1),new w(128,128,128,1),new w(248,0,0,1),new w(0,248,0,1),new w(248,248,0,1),new w(0,0,248,1),new w(248,0,248,1),new w(0,248,248,1),new w(248,248,248,1),new w(32,0,0,1),new w(63,0,0,1),new w(95,0,0,1),new w(127,0,0,1),new w(159,0,0,1),new w(191,0,0,1),new w(223,0,0,1),new w(255,0,0,1),new w(0,32,0,1),new w(0,63,0,1),new w(0,95,0,1),new w(0,127,0,1),new w(0,159,0,1),new w(0,191,0,1),new w(0,223,0,1),new w(0,255,0,1),new w(32,32,0,1),new w(63,63,0,1),new w(95,95,0,1),new w(127,127,0,1),new w(159,159,0,1),new w(191,191,0,1),new w(223,223,0,1),new w(255,255,0,1),new w(0,0,32,1),new w(0,0,63,1),new w(0,0,95,1),new w(0,0,127,1),new w(0,0,159,1),new w(0,0,191,1),new w(0,0,223,1),new w(0,0,255,1),new w(32,0,32,1),new w(63,0,63,1),new w(95,0,95,1),new w(127,0,127,1),new w(159,0,159,1),new w(191,0,191,1),new w(223,0,223,1),new w(255,0,255,1),new w(0,32,32,1),new w(0,63,63,1),new w(0,95,95,1),new w(0,127,127,1),new w(0,159,159,1),new w(0,191,191,1),new w(0,223,223,1),new w(0,255,255,1),new w(16,16,16,1),new w(31,31,31,1),new w(47,47,47,1),new w(63,63,63,1),new w(79,79,79,1),new w(95,95,95,1),new w(111,111,111,1),new w(127,127,127,1),new w(143,143,143,1),new w(159,159,159,1),new w(175,175,175,1),new w(191,191,191,1),new w(207,207,207,1),new w(223,223,223,1),new w(239,239,239,1),new w(255,255,255,1),new w(255,0,0,1),new w(255,31,0,1),new w(255,63,0,1),new w(255,95,0,1),new w(255,127,0,1),new w(255,159,0,1),new w(255,191,0,1),new w(255,223,0,1),new w(255,255,0,1),new w(224,255,0,1),new w(192,255,0,1),new w(160,255,0,1),new w(128,255,0,1),new w(96,255,0,1),new w(64,255,0,1),new w(32,255,0,1),new w(0,255,0,1),new w(0,255,31,1),new w(0,255,63,1),new w(0,255,95,1),new w(0,255,127,1),new w(0,255,159,1),new w(0,255,191,1),new w(0,255,223,1),new w(0,255,255,1),new w(0,224,255,1),new w(0,192,255,1),new w(0,160,255,1),new w(0,128,255,1),new w(0,96,255,1),new w(0,64,255,1),new w(0,32,255,1),new w(0,0,255,1),new w(31,0,255,1),new w(63,0,255,1),new w(95,0,255,1),new w(127,0,255,1),new w(159,0,255,1),new w(191,0,255,1),new w(223,0,255,1),new w(255,0,255,1),new w(255,0,224,1),new w(255,0,192,1),new w(255,0,160,1),new w(255,0,128,1),new w(255,0,96,1),new w(255,0,64,1),new w(255,0,32,1),new w(255,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(0,0,0,1),new w(8,8,8,1),new w(16,16,16,1),new w(24,24,24,1),new w(32,32,32,1),new w(41,41,41,1),new w(49,49,49,1),new w(57,57,57,1),new w(65,65,65,1),new w(74,74,74,1),new w(82,82,82,1),new w(90,90,90,1),new w(98,98,98,1),new w(106,106,106,1),new w(115,115,115,1),new w(123,123,123,1),new w(131,131,131,1),new w(139,139,139,1),new w(148,148,148,1),new w(156,156,156,1),new w(164,164,164,1),new w(172,172,172,1),new w(180,180,180,1),new w(189,189,189,1),new w(197,197,197,1),new w(205,205,205,1),new w(213,213,213,1),new w(222,222,222,1),new w(230,230,230,1),new w(238,238,238,1),new w(246,246,246,1),new w(255,255,255,1)];function k(e,t,n){switch(t){case 3:return N(e);case 4:return function(e,t){if(!t)return console.error("Tried to generate mode 4 header string with no palette! Falling back to mode 3..."),N(e);for(var n=e.getImageDataStore(),a=n.fileName,r=n.dimensions,i=n.imageData,o=a.slice(0,a.lastIndexOf(".")),c=r.height*r.width,l="const unsigned short ".concat(o,"Bitmap[").concat(c/2,"]__attribute__((aligned(4)))=\n{\n"),s="",u=0;u<i.length;u+=2)s+=j(i[u],i[u+1]),(u/2+1)%8===0&&(s+="\n");var d=function(e){for(var t="const unsigned short powPal["+p+"] __attribute__((aligned(4)))=\n{\n",n=1;n<=e.length;n++){var a=e[n-1];t+=M(a)+",",n%8===0&&(t+="\n"),n%64===0&&(t+="\n")}return t+"};"}(t);return l+s+"};\n\n"+d}(e,n);default:return N(e)}}function N(e){for(var t=e.getImageDataStore(),n=t.fileName,a=t.dimensions,r=t.imageData,i=n.slice(0,n.lastIndexOf(".")),o=a.height*a.width,c="const unsigned short ".concat(i,"Bitmap[").concat(o/2,"]__attribute__((aligned(4)))=\n{\n\t"),l="",s=0,u=0,d=r.length;u<d;u+=4){l+=P([r[u+2],r[u+1],r[u]])+",",++s%8===0&&(l+="\n",l+=s%64===0?"\n\t":"\t")}return c+l+"\n};\n"}function S(e,t){switch(t){case 3:return I(e);case 4:return function(e){var t=e.fileName,n=e.imageDimensions;if(!e.palette)return console.error("Tried to generate mode 4 header string with no palette! Falling back to mode 3..."),I({fileName:t,imageDimensions:n});var a=t.slice(0,t.lastIndexOf(".")),r=n.height*n.width,i="#define ".concat(a.toUpperCase(),"_SIZE ").concat(r,"\n"),o="#define ".concat(a.toUpperCase(),"_HEIGHT ").concat(n.height,"\n"),c="#define ".concat(a.toUpperCase(),"_WIDTH ").concat(n.width,"\n"),l="extern const unsigned short ".concat(a,"Bitmap[").concat(r/2,"];\n\n"),s="#define ".concat(a.toUpperCase(),"_PAL_SIZE ").concat(2*p,"\n"),u="extern const unsigned short ".concat(a,"Palette[").concat(p,"];\n\n");return i+o+c+l+s+u}(e);default:return console.warn("Attempting to generate header file for mode ".concat(t,", but it's unsupported for now. Defaulting to mode 3.")),I(e)}}function I(e){var t=e.fileName,n=e.imageDimensions,a=(e.palette,t.slice(0,t.lastIndexOf("."))),r=n.height*n.width,i=2*r,o="#define ".concat(a.toUpperCase(),"_SIZE ").concat(i,"\n");return"#define ".concat(a.toUpperCase(),"_LENGTH ").concat(r,"\n")+o+"#define ".concat(a.toUpperCase(),"_HEIGHT ").concat(n.height,"\n")+"#define ".concat(a.toUpperCase(),"_WIDTH ").concat(n.width,"\n")+"\n"+"extern const unsigned short ".concat(a,"Bitmap[").concat(r,"];\n\n")+"\n"}function j(e,t){(e>255||t>255)&&console.error("Tried to convert palette indices ".concat(e," and ").concat(t,", but at least one is out of range! Truncating bitwise..."));var n=((t&=255)|(e&=255)<<8).toString(16).toUpperCase().padStart(4,"0");return"0x".concat(n,", ")}function P(e){var t="0";e.forEach((function(e){for(var n=(e=Math.floor(32*e/256)).toString(2);n.length<5;)n="0"+n;t+=n}));for(var n=parseInt(t,2).toString(16);n.length<4;)n="0"+n;return"0x"+(n=n.toUpperCase())}function M(e){return P([e.b,e.g,e.r])}function A(e,t){return D.apply(this,arguments)}function D(){return(D=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n,e.next="BMP"===e.t0||"PNG"===e.t0?3:6;break;case 3:return e.next=5,t.getImageFileBlob();case 5:return e.abrupt("return",e.sent);case 6:return e.abrupt("return",new Blob(["Invalid file type"]));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=n(13),L=n(10),R=n(9),B=n(19),G=n(14),U=function(){function e(t,n,a){Object(h.a)(this,e),this.fileName=void 0,this.dimensions=void 0,this.imageData=void 0,this.imageCanvas=void 0,this.fileName=t,this.dimensions=n,this.imageData=a||new Uint8ClampedArray(this.dimensions.width*this.dimensions.height*4)}return Object(f.a)(e,[{key:"getImageCanvasElement",value:function(){return this.imageCanvas.getImageCanvasElement()}},{key:"getPixelGridCanvasElement",value:function(){return this.imageCanvas.getPixelGridCanvasElement()}},{key:"getImageDataStore",value:function(){return{fileName:this.fileName,dimensions:this.dimensions,imageData:this.imageData}}},{key:"getImageFileBlob",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.getImageCanvasElement().toBlob((function(t){return e(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"updateImageData",value:function(e,t){this.imageData[Q(e,this.dimensions)]=t.r,this.imageData[Q(e,this.dimensions)+1]=t.g,this.imageData[Q(e,this.dimensions)+2]=t.b,this.imageData[Q(e,this.dimensions)+3]=t.a}}]),e}(),_=function(){function e(t){Object(h.a)(this,e),this.dimensions=void 0,this.pixelGridRatio=16,this.hiddenCanvas=void 0,this.context=void 0,this.pixelGrid=void 0,console.log("Creating new internal ImageCanvas."),this.dimensions=t.dimensions,this.hiddenCanvas=W(t.dimensions),this.context=this.hiddenCanvas.getContext("2d"),this.pixelGrid=new H(t.dimensions,this.pixelGridRatio),this.drawImageToHiddenCanvas(t)}return Object(f.a)(e,[{key:"getImageCanvasElement",value:function(){return this.hiddenCanvas}},{key:"getPixelGridCanvasElement",value:function(){return this.pixelGrid.getCanvasElement()}},{key:"updatePixel",value:function(e,t){this.drawPixel(e,t)}},{key:"updateRegion",value:function(e,t,n,a,r){}},{key:"redrawImage",value:function(e){this.drawImageToHiddenCanvas(e)}},{key:"drawPixel",value:function(e,t){if(this.context){var n="rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", 1)");this.context.fillStyle=n,this.context.fillRect(e.x,e.y,1,1)}}},{key:"drawImageToHiddenCanvas",value:function(e){for(var t=0;t<e.dimensions.width;t++)for(var n=0;n<e.dimensions.height;n++)this.drawPixel({x:t,y:n},e.getPixelColorAt({x:t,y:n}))}}]),e}(),H=function(){function e(t,n){Object(h.a)(this,e),this.dimensions=void 0,this.pixelGridRatio=16,this.hiddenCanvas=void 0,this.context=void 0,console.log("Setting up pixel grid."),this.pixelGridRatio=n,this.dimensions=t,this.hiddenCanvas=W({width:this.dimensions.width*this.pixelGridRatio,height:this.dimensions.height*this.pixelGridRatio}),this.context=this.hiddenCanvas.getContext("2d"),this.drawGrid()}return Object(f.a)(e,[{key:"getCanvasElement",value:function(){return this.hiddenCanvas}},{key:"drawGrid",value:function(){if(this.context){var e=this.dimensions,t=e.width,n=e.height;this.context.strokeStyle="gray",this.context.beginPath();for(var a=0;a<=t;a++)this.context.moveTo(a*this.pixelGridRatio,0),this.context.lineTo(a*this.pixelGridRatio,n*this.pixelGridRatio);for(var r=0;r<=n;r++)this.context.moveTo(0,r*this.pixelGridRatio),this.context.lineTo(t*this.pixelGridRatio,r*this.pixelGridRatio);this.context.stroke()}}}]),e}(),J=function(e){function t(e,n,a){var r;return Object(h.a)(this,t),(r=Object(T.a)(this,Object(R.a)(t).call(this,e,n,a))).imageCanvas=void 0,r.imageCanvas=new _(Object(L.a)(r)),r}return Object(G.a)(t,e),Object(f.a)(t,[{key:"getCSourceData",value:function(){return k(this,3)}},{key:"getHeaderData",value:function(){return S({fileName:this.fileName,imageDimensions:this.dimensions},3)}},{key:"getPixelColorAt",value:function(e){var t=this.imageData[Q(e,this.dimensions)],n=this.imageData[Q(e,this.dimensions)+1],a=this.imageData[Q(e,this.dimensions)+2],r=this.imageData[Q(e,this.dimensions)+3];return new w(t,n,a,r)}},{key:"setPixelColor",value:function(e,n){Object(B.a)(Object(R.a)(t.prototype),"updateImageData",this).call(this,e,n),this.imageCanvas.updatePixel(e,n)}}],[{key:"fromDataStore",value:function(e){var n=e.imageData,a=e.dimensions;return new t(e.fileName,a,n)}}]),t}(U),W=function(e){var t=document.createElement("canvas");return t.hidden=!0,t.setAttribute("height",e.height+"px"),t.setAttribute("width",e.width+"px"),t},F=function(e,t){return e.getContext("2d").getImageData(0,0,t.width,t.height).data},z=function(e){return new Promise((function(t,n){var a=new Image;a.hidden=!0,a.onload=function(){t(a)},a.onerror=n,a.src=URL.createObjectURL(e)}))},q=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a,r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(t);case 2:return n=e.sent,a={height:n.naturalHeight,width:n.naturalWidth},r=W(a),(i=r.getContext("2d"))&&i.drawImage(n,0,0),o=F(r,a),e.abrupt("return",new J(t.name,a,o));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(e,t){return 4*(e.y*t.width+e.x)},K=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a,r,i,o,c,l,u,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Response(t).text();case 2:if(n=e.sent,a=n.trim().replace(/\t/g,"").replace(/\n/g,""),r=new Array(256),"0x00"!==a.substr(0,4)){e.next=11;break}for(console.log("Palette file is valid. Generating color array..."),i=0,o=0;i<a.length;i+=10,o++)c=parseInt(a.substr(i+4,2),16),l=parseInt(a.substr(i+6,2),16),u=parseInt(a.substr(i+8,2),16),d=new w(c,l,u,1),r[o]=d;return e.abrupt("return",r);case 11:return console.log("Invalid palette. Palette unchanged."),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(e){function t(e,n,a,r){var i;return Object(h.a)(this,t),(i=Object(T.a)(this,Object(R.a)(t).call(this,e,a))).data=void 0,i.palette=void 0,i.currentPaletteIndex=void 0,i.imageCanvas=void 0,i.data=r||Array(a.height*a.width).fill(0),i.palette=n,i.imageCanvas=new _(Object(L.a)(i)),i.currentPaletteIndex=0,i}return Object(G.a)(t,e),Object(f.a)(t,[{key:"getHeaderData",value:function(){return S({fileName:this.fileName,imageDimensions:this.dimensions,palette:this.palette},4)}},{key:"getCSourceData",value:function(){return k(this,4,this.palette)}},{key:"getPixelColorAt",value:function(e){return(e.x>=this.dimensions.width||e.y>=this.dimensions.height)&&console.error("Tried to access pixel at",e,"but dimensions of sprite are",this.dimensions),this.palette[this.data[this.dimensions.width*e.y+e.x]]}},{key:"setPixelColor",value:function(e){this.data[e.y*this.dimensions.width+e.x]=this.currentPaletteIndex,this.imageCanvas.updatePixel(e,this.palette[this.currentPaletteIndex])}},{key:"setPaletteIndex",value:function(e){this.currentPaletteIndex=e}},{key:"updatePalette",value:function(e){this.palette=e,this.imageCanvas.redrawImage(this)}},{key:"getImageDataStore",value:function(){return{imageData:this.data,dimensions:this.dimensions,fileName:this.fileName}}}],[{key:"fromDataStore",value:function(e,n){var a=e.imageData,r=e.dimensions;return new t(e.fileName,n,r,a)}}]),t}(U),V=new w(0,0,0,1);function Y(e,t){for(var n,a=function(e){for(var t=[],n=0;n<e.dimensions.height;n++)for(var a=0;a<e.dimensions.width;a++){var r=e.getPixelColorAt({x:a,y:n});t.push([Math.round(Math.min(Math.max(r.r,0),255)),Math.round(Math.min(Math.max(r.g,0),255)),Math.round(Math.min(Math.max(r.b,0),255))])}return t}(e),r=t,i=[],o=[],c=0;c<a.length;c++){var l=a[c];o.includes(JSON.stringify(l))||(i.push(l),o.push(JSON.stringify(l)))}if(1===r||i.length<r)n=i,r=i.length;else{var s=function(e,t){var n=442,a=0,r=(n+a)/2,i=0,o=[];for(;a<=n;){var c=$(e,r=(n+a)/2,t),l=c.possible,s=c.centers;l?(i<r&&(o=JSON.parse(JSON.stringify(s)),i=r),a=r+1):n=r-1}return{pickedCentroids:o}}(i,r).pickedCentroids;n=JSON.parse(JSON.stringify(s))}for(var u=function(e,t,n){var a=[],r=0,i=0,o=JSON.parse(JSON.stringify(t)),c=!1;do{for(var l=0;l<n;l++)a[l]=[];c=!1,c=!1;for(var s=0;s<e.length;s++){for(var u=-1,d=0,m=0;m<n;m++){for(var h=0,f=0;f<e[s].length;f++)h+=Math.pow(Math.abs(e[s][f]-t[m][f]),2);i=Math.sqrt(h),(-1===u||i<=u)&&(u=i,d=m)}a[d].push(e[s].slice())}for(var w=0;w<n;w++){for(var g=0;g<a[w].length;g++)for(var v=0;v<a[w][g].length;v++)t[w][v]+=a[w][g][v];for(var p=0;p<t[w].length;p++)t[w][p]=Math.round(Math.min(Math.max(t[w][p]/(a[w].length<=1?1:a[w].length),0),255)),t[w][p]!==o[w][p]&&(c=!0,o=[],o=JSON.parse(JSON.stringify(t)))}r++}while(!0===c&&r<1e3);return console.log("kmeans output:"),console.log(r),console.log(".........."),{groups:a,centers:t}}(JSON.parse(JSON.stringify(a)),JSON.parse(JSON.stringify(n)),r),d=u.groups,m=u.centers,h=[],f=0;f<m.length;f++){var g=[[],[]];g[0]=m[f];for(var v=0;v<d[f].length;v++)g[v+1]=d[f][v];h.push(g)}h.sort((function(e,t){return t.length-e.length})),console.log(h);var p=e.dimensions.height*e.dimensions.width,b=new Array(p);b.fill(0);for(var E=new Array(256),x=0;x<h.length&&x<256;x++){var C=new w(h[x][0][0],h[x][0][1],h[x][0][2],1);E[x]=C;for(var y=1;y<h[x].length;y++){var O=X(a,h[x][y]);-1!==O&&(b[O]=x)}}for(;x<256;x++)E[x]=V;return{sprite:new Z(e.fileName,E,e.dimensions,b),palette:E}}function X(e,t){for(var n=0;n<e.length;n++)if(e[n][0]===t[0]&&e[n][1]===t[1]&&e[n][2]===t[2])return e[n]=[-1,-1,-1],n;return-1}function $(e,t,n){var a=1,r=e[0],i=!1,o=[];o.push(r);for(var c=0;c<e.length;c++){for(var l=0,s=0;s<e[c].length;s++)l+=Math.pow(Math.abs(e[c][s]-r[s]),2);if((l=Math.sqrt(l))>=t&&(a++,r=e[c],o.push(e[c]),a>=n))return{possible:i=!0,centers:o}}return{possible:i,centers:o}}var ee=function(e){var t=e.startImageExport,n=e.buttonLabel;return i.a.createElement("button",{className:"button export-button",onClick:function(){t()}},n)};var te=function(e){var t=e.onFileInputChange,n=e.buttonLabel,a=Object(r.useRef)(null);return i.a.createElement(i.a.Fragment,null,i.a.createElement("label",null,n,i.a.createElement("input",{type:"file",accept:".png, .jpg, .jpeg, .bmp, .pal",ref:a,onChange:function(e){return t(a.current,e)}})))};function ne(e){var t=e.label,n=e.children,a=Object(r.useState)(!1),o=Object(d.a)(a,2),c=o[0],l=o[1];return i.a.createElement("div",{className:"dd-container"},i.a.createElement("button",{onClick:function(){return l(!c)},className:"dd-button"},t),i.a.createElement("div",{id:"myDropdown",className:c?"dd-content dd-show":"dd-content",onClick:function(){return l(!1)}},n))}function ae(e){var t=e.image,n=e.palette,a=e.selectedPaletteIndex,o=e.settings,c=e.scale,l=e.onChangeImage,s=e.onMouseWheel,u=Object(r.useRef)(null),m=Object(r.useState)([0,0]),h=Object(d.a)(m,2),f=h[0],w=h[1],v=Object(r.useState)(!1),p=Object(d.a)(v,2),b=p[0],E=p[1],x=Object(r.useState)(void 0),C=Object(d.a)(x,2),y=C[0],O=C[1],k=Object(r.useState)({x:0,y:0}),N=Object(d.a)(k,2),S=N[0],I=N[1],j=Object(r.useCallback)((function(){var e=u.current;if(e){var n=e.getContext("2d");n&&t&&(n.clearRect(0,0,e.width,e.height),n.drawImage(t.getImageCanvasElement(),S.x,S.y,t.dimensions.width*c,t.dimensions.height*c),o.grid&&c>=8&&n.drawImage(t.getPixelGridCanvasElement(),S.x,S.y,t.dimensions.width*c,t.dimensions.height*c))}}),[t,S,u,c,o.grid]);Object(r.useLayoutEffect)((function(){window.addEventListener("resize",(function(){u.current&&w([u.current.clientWidth,u.current.clientHeight])}))}),[]),Object(r.useLayoutEffect)((function(){console.log("Setting up canvas...");var e=u.current;if(e){var t=e.getContext("2d");t&&(w([e.clientWidth,e.clientHeight]),t.imageSmoothingEnabled=!1)}}),[u]),Object(r.useLayoutEffect)((function(){var e=u.current;if(e){var t=e.getContext("2d");if(t){var n=window.devicePixelRatio||1;e.width=f[0]*n,e.height=f[1]*n,t.imageSmoothingEnabled=!1}}}),[f,u]),Object(r.useLayoutEffect)((function(){u.current&&u.current.addEventListener("wheel",s)}),[s]),Object(r.useLayoutEffect)((function(){return j()}),[j,n,f]);var P=function(e){var t=u.current;if(t){var n=t.getBoundingClientRect(),a=t.width/n.width,r=t.height/n.height;return{x:(e.clientX-n.left)*a,y:(e.clientY-n.top)*r}}},M=Object(r.useCallback)((function(e){var n=Math.floor((e.x-S.x)/c),a=Math.floor((e.y-S.y)/c);if(!(n<0||n>t.dimensions.width||a<0||a>t.dimensions.height))return{x:n,y:a}}),[c,S,t.dimensions]),A=Object(r.useCallback)((function(e,n){e&&(u.current&&u.current.getContext("2d")&&(t.setPixelColor(e,n),j()))}),[j,t]),D=Object(r.useCallback)((function(e,n){if(e){var a=t.getPixelColorAt(e);if(!a.isEqual(n)){t.setPixelColor(e,n),console.log(a);for(var r=new Array(e),i=new Array(e);void 0!==r[0];){var o=r.shift(),c=new Array(0);o.y>0&&c.push({x:o.x,y:o.y-1}),o.y<t.dimensions.height-1&&c.push({x:o.x,y:o.y+1}),o.x>0&&c.push({x:o.x-1,y:o.y}),o.x<t.dimensions.width-1&&c.push({x:o.x+1,y:o.y}),c.filter((function(e){return!i.includes(e)})).forEach((function(e){i.push(e),t.getPixelColorAt(e).isEqual(a)&&(r.push(e),t.setPixelColor(e,n))}))}j()}}}),[t,j]),T=Object(r.useCallback)((function(e){var t=P(e);if(t){O(t);var r=M(t);switch(o.currentTool){case g.PENCIL:E(!0),A(r,n[a]);break;case g.BUCKET:D(r,n[a]);break;case g.PAN:E(!0)}}}),[o.currentTool,D,A,M,n,a]),L=Object(r.useCallback)((function(e){var t=P(e);if(t){var r=M(t);switch(o.currentTool){case g.PENCIL:b&&A(r,n[a]);break;case g.PAN:if(b&&y){var i={x:S.x+(t.x-y.x),y:S.y+(t.y-y.y)};I(i)}}O(t)}}),[b,A,M,n,a,S,y,o.currentTool]),R=Object(r.useCallback)((function(){O(void 0),E(!1),l(t)}),[t,l]);return Object(r.useEffect)((function(){if(u.current){var e=u.current;return e.addEventListener("mousedown",T),function(){return e.removeEventListener("mousedown",T)}}}),[T]),Object(r.useEffect)((function(){if(u.current){var e=u.current;return e.addEventListener("mousemove",L),function(){e.removeEventListener("mousemove",L)}}}),[L]),Object(r.useEffect)((function(){if(u.current){var e=u.current;return e.addEventListener("mouseup",R),e.addEventListener("mouseleave",R),function(){e.removeEventListener("mouseup",R),e.removeEventListener("mouseleave",R)}}}),[R]),i.a.createElement("canvas",{ref:u,className:re(o.currentTool)})}var re=function(e){var t="image-canvas ";switch(e){case g.PENCIL:return t+"pencil";case g.BUCKET:return t+"bucket";case g.PAN:return t+"pan"}return t};function ie(e,t){var n=t.getContext("2d");if(n)for(var a=0;a<p;a++){var r=e[a];n.fillStyle="rgb(".concat(r.r,", ").concat(r.g,", ").concat(r.b,")"),n.fillRect(a%16,Math.floor(a/16),1,1)}else console.error("Failed to get Palette hidden canvas context!")}var oe=192,ce=192,le=oe/16,se=function(e){return function(e){var t=e.x;return 16*e.y+t}(function(e){var t=e.x,n=e.y;return{x:Math.floor(t/le),y:Math.floor(n/le)}}(e))};var ue=function(e){var t=e.palette,n=e.selectedColorIndex,a=e.onChangeSelectedColorIndex,o=Object(r.useState)(),c=Object(d.a)(o,2),l=c[0],s=c[1],u=Object(r.useState)(),m=Object(d.a)(u,2),h=m[0],f=m[1],w=Object(r.useRef)(null),g=Object(r.useCallback)((function(){if(w.current&&h){var e=w.current.getContext("2d");e&&e.drawImage(h.getCanvasElement(),0,0,ce*window.devicePixelRatio,oe*window.devicePixelRatio)}}),[h]),p=Object(r.useCallback)((function(){if(w.current&&l){var e=w.current.getContext("2d");e&&(ie(t,l),e.drawImage(l,0,0,ce*window.devicePixelRatio,oe*window.devicePixelRatio))}}),[t,l]),b=Object(r.useCallback)((function(e){if(w.current){var t=w.current.getContext("2d");if(t){t.beginPath(),t.strokeStyle="rgba(255, 255, 0, 1)",t.lineWidth=2;var n=window.devicePixelRatio*le;t.rect(function(e){return e%16}(e)*n,function(e){return Math.floor(e/16)}(e)*n,n,n),t.stroke()}}}),[w]);return Object(r.useEffect)((function(){console.log("Setting up palette canvas");w.current&&function(e){var t=window.devicePixelRatio||1;e.width=e.clientWidth*t,e.height=e.clientHeight*t;var n=e.getContext("2d");n&&(n.imageSmoothingEnabled=!1)}(w.current);var e={pixelGrid:new H(v,8),hiddenCanvas:W(v)},t=e.pixelGrid;s(e.hiddenCanvas),f(t)}),[]),Object(r.useEffect)((function(){p(),g(),b(n)}),[n,p,g,b]),i.a.createElement("canvas",{ref:w,onClick:function(e){a(se(function(e){if(w.current){var t=w.current.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}return{x:-1,y:-1}}(e)))},className:"palette-canvas"})};var de=function(e){var t=e.handleQuantize,n=Object(r.useState)(15),a=Object(d.a)(n,2),o=a[0],c=a[1];return i.a.createElement("div",{className:"quantize-container"},i.a.createElement("button",{className:"quantize-button",onClick:function(){o?t(o):alert("Can't quantize with unspecified color depth!")}},"Quantize"),i.a.createElement("input",{className:"quantize-input",type:"number",value:o,min:1,max:256,onChange:function(e){return c(parseInt(e.target.value))}}))};function me(e){var t=e.palette,n=e.selectedColorIndex,a=e.onChangeSelectedColorIndex,r=e.onChangeColor,o=e.handleQuantize,c=e.settings;e.onSettingsChange;return i.a.createElement("div",null,i.a.createElement("div",{className:"panel-label"},"Color Palette"),i.a.createElement("div",{className:"palette-container"},i.a.createElement(ue,{palette:t,selectedColorIndex:n,onChangeSelectedColorIndex:a})),i.a.createElement(fe,{currentColor:t[n],onChangeColor:r}),i.a.createElement(de,{handleQuantize:o}),i.a.createElement("div",{className:"heading"},"Settings"),i.a.createElement("div",null,"Mode: ",c.editorMode,i.a.createElement("br",null),c.editorMode.toString()))}var he=function(e){var t=8*(e.r+1)-1,n=8*(e.g+1)-1,a=8*(e.b+1)-1;return new w(t,n,a,1)};function fe(e){var t=e.currentColor,n=e.onChangeColor,a=function(e){var t=Math.ceil((e.r+1)/8)-1,n=Math.ceil((e.g+1)/8)-1,a=Math.ceil((e.b+1)/8)-1;return new w(t,n,a,1)}(t);return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("label",null,"R"),i.a.createElement("input",{type:"number",max:"31",min:"0",value:a.r,onChange:function(e){return function(e){a.r=e;var t=he(a);n(t)}(parseInt(e.target.value))}})),i.a.createElement("div",null,i.a.createElement("label",null,"G"),i.a.createElement("input",{type:"number",max:"31",min:"0",value:a.g,onChange:function(e){return function(e){a.g=e;var t=he(a);n(t)}(parseInt(e.target.value))}})),i.a.createElement("div",null,i.a.createElement("label",null,"B"),i.a.createElement("input",{type:"number",max:"31",min:"0",value:a.b,onChange:function(e){return function(e){a.b=e;var t=he(a);n(t)}(parseInt(e.target.value))}})))}var we=n(20),ge=n(8),ve=n(16),pe=n(7);function be(e){var t=e.state,n=e.onClick,a=e.children;return i.a.createElement("button",{className:t?"toggle-on":"toggle-off",onClick:function(){return n(!t)}},a)}function Ee(e){var t=e.settings,n=e.onSettingsChange,a=e.onToolChange;return i.a.createElement("div",null,i.a.createElement("div",{className:"heading"},"Tools"),i.a.createElement(be,{state:t.currentTool===g.PENCIL,onClick:function(){return a(g.PENCIL)}},i.a.createElement(pe.a,{icon:ge.f})),i.a.createElement(be,{state:t.currentTool===g.BUCKET,onClick:function(){return a(g.BUCKET)}},i.a.createElement(pe.a,{icon:ge.d})),i.a.createElement(be,{state:t.currentTool===g.SQUARE,onClick:function(){return a(g.SQUARE)}},i.a.createElement(pe.a,{icon:ve.c})),i.a.createElement(be,{state:t.currentTool===g.ELLIPSE,onClick:function(){return a(g.ELLIPSE)}},i.a.createElement(pe.a,{icon:ve.a})),i.a.createElement(be,{state:t.currentTool===g.ZOOM,onClick:function(){return a(g.ZOOM)}},i.a.createElement(pe.a,{icon:ge.g})),i.a.createElement(be,{state:t.currentTool===g.PAN,onClick:function(){return a(g.PAN)}},i.a.createElement(pe.a,{icon:ve.b})),i.a.createElement(be,{state:t.currentTool===g.DROPPER,onClick:function(){return a(g.DROPPER)}},i.a.createElement(pe.a,{icon:ge.c})),i.a.createElement("div",{className:"heading"},"View"),i.a.createElement(be,{state:t.grid,onClick:function(){var e=Object(we.a)({},t);e.grid=!t.grid,n(e)}},i.a.createElement(pe.a,{icon:ge.a})),i.a.createElement(be,{state:!1,onClick:function(){return null}},i.a.createElement(pe.a,{icon:ge.e})),i.a.createElement(be,{state:!1,onClick:function(){return null}},i.a.createElement(pe.a,{icon:ge.b})))}var xe=function(e){var t=e.onAccept,n=Object(r.useState)("untitled"),a=Object(d.a)(n,2),o=a[0],c=a[1],l=Object(r.useState)(32),s=Object(d.a)(l,2),u=s[0],m=s[1],h=Object(r.useState)(32),f=Object(d.a)(h,2),w=f[0],g=f[1];return i.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(o,{height:u,width:w})}},i.a.createElement("div",{className:"modal-input-text"},i.a.createElement("label",{htmlFor:"filename",className:"modal-label"},"Name:"),i.a.createElement("input",{id:"filename",name:"filename",type:"text",value:o,onChange:function(e){return c(e.target.value)}})),i.a.createElement("br",null),i.a.createElement("label",{className:"modal-label"},"Image Size"),i.a.createElement("div",{className:"modal-input-num"},i.a.createElement("label",{htmlFor:"height",className:"modal-label-num"},"Height:"),i.a.createElement("input",{id:"height",type:"number",min:1,value:u,onChange:function(e){return m(parseInt(e.target.value))}}),i.a.createElement("label",null,"\xa0px"),i.a.createElement("br",null),i.a.createElement("label",{htmlFor:"width",className:"modal-label-num"},"Width:"),i.a.createElement("input",{id:"width",type:"number",min:1,value:w,onChange:function(e){return g(parseInt(e.target.value))}}),i.a.createElement("label",null,"\xa0px")),i.a.createElement("br",null),i.a.createElement("div",{className:"modal-button-left"},i.a.createElement("button",{className:"modal-button"},"OK")))},Ce=function(e){var t=e.onAccept,n=e.isShowing,a=e.hide;return n?c.a.createPortal(i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"modal-overlay"}),i.a.createElement("div",{className:"modal-wrapper","aria-modal":!0,"aria-hidden":!0,tabIndex:-1,role:"dialog"},i.a.createElement("div",{className:"modal"},i.a.createElement("div",{className:"modal-header"},"Create a New Image"),i.a.createElement(xe,{onAccept:function(e,n){t(e,n),a()}}),i.a.createElement("div",{className:"modal-button-right"},i.a.createElement("button",{onClick:a,className:"modal-button"},"Cancel"))))),document.body):null},ye=function(){var e=Object(r.useState)(!1),t=Object(d.a)(e,2),n=t[0],a=t[1];return{isShowing:n,toggle:function(){return a(!n)}}};function Oe(e,t){return 1===(t.deltaY<0?-1:1)?1.1*e:e/1.1}var ke=function(){var e=Object(r.useState)(),t=Object(d.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(O),l=Object(d.a)(c,2),h=l[0],f=l[1],w=Object(r.useState)(0),v=Object(d.a)(w,2),p=v[0],k=v[1],N=Object(r.useState)({grid:!0,currentTool:g.PENCIL,imageMode:3,editorMode:a.Bitmap}),S=Object(d.a)(N,2),I=S[0],j=S[1],P=ye(),M=P.isShowing,D=P.toggle,T=ye(),L=T.isShowing,R=T.toggle,B=Object(r.useReducer)(Oe,8),G=Object(d.a)(B,2),U=G[0],_=G[1],H=Object(r.useCallback)((function(e){return _(e)}),[]),W=function(e,t,n){if(n.preventDefault(),t&&t.files)switch(e){case"Image":F(t.files[0]);break;case"Palette":X(t.files[0])}},F=function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return console.log("Loading image from file..."),e.next=4,q(t);case 4:n=e.sent,o(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(e){window.localStorage.setItem(b,JSON.stringify(e.getImageDataStore())),o(e)},Q=function(e){window.localStorage.setItem(E,JSON.stringify(e)),f(e)},V=function(e){window.localStorage.setItem(x,e.imageMode.toString()),window.localStorage.setItem(C,e.editorMode.toString()),j(e)},X=function(){var e=Object(u.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return console.log("Loading palette from file..."),e.next=4,K(t);case 4:(a=e.sent)&&(n instanceof Z&&n.updatePalette(a),Q(a));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=Object(r.useCallback)((function(e){V({grid:I.grid,currentTool:e,imageMode:I.imageMode,editorMode:I.editorMode})}),[I]),re=function(e,t,r,i){if(n&&!window.confirm("Are you sure you want to create a new image? You will lose all unsaved work."))return;switch(e){case a.Bitmap:switch(t){case 3:I.editorMode=a.Bitmap,I.imageMode=3,V(I),z(new J(r,i)),Q(h);break;case 4:I.editorMode=a.Bitmap,I.imageMode=4,V(I),z(new Z(r,h,i)),Q(h);break;default:alert("Unsupported image mode!")}break;case a.Spritesheet:case a.Background:default:alert("Unsupported editing mode!")}},ie=function(){var e=Object(u.a)(s.a.mark((function e(t){var a,r,i,o,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r="",a=n?n.fileName.slice(0,n.fileName.lastIndexOf(".")):"default",o=function(){return alert("Failed to export image! Check console for more information.")},e.t0=t,e.next="GBA"===e.t0?6:"PAL"===e.t0?16:"BMP"===e.t0?24:"PNG"===e.t0?32:40;break;case 6:if(n){e.next=9;break}return alert("No image to export! Try importing one first."),e.abrupt("return");case 9:return r=".c",c=new Blob([n.getCSourceData()]),Object(m.saveAs)(c,a+r),r=".h",l=new Blob([n.getHeaderData()]),Object(m.saveAs)(l,a+r),e.abrupt("return");case 16:if(h){e.next=21;break}return alert("Can't export a non-existant palette!"),e.abrupt("return");case 21:return r=".pal",i=new Blob([(s=h,function(e){var t="",n=1;return e.forEach((function(e){var a="0x00";a+=e.r<16?"0"+e.r.toString(16):e.r.toString(16),a+=e.g<16?"0"+e.g.toString(16):e.g.toString(16),a+=e.b<16?"0"+e.b.toString(16):e.b.toString(16),t+=a+"\t",4===n?(t+="\n",n=1):n++})),t}(s))]),e.abrupt("break",47);case 24:if(n){e.next=27;break}return alert("No image to export! Try importing one first."),e.abrupt("return");case 27:return r=".bmp",e.next=30,A(n,t);case 30:return i=e.sent,e.abrupt("break",47);case 32:if(n){e.next=35;break}return alert("No image to export! Try importing one first."),e.abrupt("return");case 35:return r=".png",e.next=38,A(n,t);case 38:return i=e.sent,e.abrupt("break",47);case 40:if(n){e.next=43;break}return alert("No image to export! Try importing one first."),e.abrupt("return");case 43:return r=".txt",e.next=46,A(n,t);case 46:i=e.sent;case 47:i?Object(m.saveAs)(i,a+r):o();case 48:case"end":return e.stop()}var s}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){var e=function(){return alert("Image data incorrectly formatted. Aborting load operation.")},t=window.localStorage.getItem(x),n=window.localStorage.getItem(C),a=window.localStorage.getItem(E),r=window.localStorage.getItem(b);if(t&&n&&r){if(!window.confirm("Found automatically saved image data from your last session in storage. Would you like to load it? If not, it will be deleted."))return void window.localStorage.clear();var i=JSON.parse(r),c=parseInt(t),l=n;switch(c){case 3:o(J.fromDataStore(i));var s=y;s.imageMode=c,s.editorMode=l,j(s);break;case 4:if(!a)return void e();var u=JSON.parse(a);o(Z.fromDataStore(i,u)),f(u);var d=y;d.imageMode=c,d.editorMode=l,j(d);break;default:e()}}}),[]),i.a.createElement("div",{className:"app-container"},i.a.createElement("div",{className:"navbar"},i.a.createElement("span",{className:"title"},"VOCC"),i.a.createElement(ne,{label:"New"},i.a.createElement("div",{className:"dd-content-header"},"Bitmap"),i.a.createElement("button",{onClick:D},"Mode 3"),i.a.createElement(Ce,{isShowing:M,hide:D,onAccept:re.bind(null,a.Bitmap,3)}),i.a.createElement("button",{onClick:R},"Mode 4"),i.a.createElement(Ce,{isShowing:L,hide:R,onAccept:re.bind(null,a.Bitmap,4)}),i.a.createElement("div",{className:"dd-divider"}),i.a.createElement("div",{className:"dd-content-header"},"Spritesheet"),i.a.createElement("button",{onClick:function(){return alert("Spritesheet editing not currently supported.")}},"4 bpp"),i.a.createElement("div",{className:"dd-divider"}),i.a.createElement("div",{className:"dd-content-header"},"Background"),i.a.createElement("button",{onClick:function(){return alert("Background editing not currently supported.")}},"Mode 0")),i.a.createElement(ne,{label:"Edit"},i.a.createElement("button",{onClick:function(){return null}},"Undo"),i.a.createElement("button",{onClick:function(){return null}},"Redo"),i.a.createElement("div",{className:"dd-divider"}),i.a.createElement("button",{onClick:function(){return null}},"Clear All")),i.a.createElement(ne,{label:"Import"},i.a.createElement("div",{className:"dd-content-header"},"Image"),i.a.createElement(te,{onFileInputChange:W.bind(null,"Image"),buttonLabel:"Image (*.png, *.bmp, *.jpg)"}),i.a.createElement("div",{className:"dd-divider"}),i.a.createElement(te,{onFileInputChange:W.bind(null,"Palette"),buttonLabel:"Color Palette (*.pal)"})),i.a.createElement(ne,{label:"Export"},i.a.createElement("div",{className:"dd-content-header"},"Image"),i.a.createElement(ee,{startImageExport:ie.bind(null,"PNG"),buttonLabel:"PNG Image (*.png)"}),i.a.createElement(ee,{startImageExport:ie.bind(null,"BMP"),buttonLabel:"Bitmap (*.bmp)"}),i.a.createElement("div",{className:"dd-divider"}),i.a.createElement("div",{className:"dd-content-header"},"GBA"),i.a.createElement(ee,{startImageExport:ie.bind(null,"GBA"),buttonLabel:"C Source Code (*.c/.h)"}),i.a.createElement("div",{className:"dd-divider"}),i.a.createElement(ee,{startImageExport:ie.bind(null,"PAL"),buttonLabel:"Color Palette (*.pal)"})),i.a.createElement(ne,{label:"Help"},i.a.createElement("form",null,i.a.createElement("button",{type:"submit",formAction:"",formTarget:""},"Documentation")),i.a.createElement("form",null,i.a.createElement("button",{type:"submit",formAction:"https://www.coranac.com/tonc/text/",formTarget:"_blank"},"GBA Graphics 101")),i.a.createElement("div",{className:"dd-divider"}),i.a.createElement("form",null,i.a.createElement("button",{type:"submit",formAction:"",formTarget:""},"About VOCC")),i.a.createElement("div",{className:"dd-divider"}),i.a.createElement("form",null,i.a.createElement("button",{type:"submit",formAction:"https://github.com/lbussell/vocc",formTarget:"_blank"},"View on GitHub")),i.a.createElement("button",{onClick:function(){return window.localStorage.clear()}},"Clear Local Storage"))),i.a.createElement("div",{className:"workspace-container"},i.a.createElement("div",{className:"left-panel"},i.a.createElement("div",{className:"tools-container"},i.a.createElement(Ee,{settings:I,onSettingsChange:V,onToolChange:$})),n?i.a.createElement("div",null," Scale: ",U.toFixed(2),"x "):null),i.a.createElement("div",{className:"image-container"},n?i.a.createElement(ae,{image:n,settings:I,palette:h,selectedPaletteIndex:p,scale:U,onChangeImage:z,onMouseWheel:H}):i.a.createElement("div",{className:"start-message"},i.a.createElement("em",null,"Import an image to get started"))),i.a.createElement("div",{className:"right-panel"},i.a.createElement(me,{palette:h,updatePalette:Q,selectedColorIndex:p,onChangeSelectedColorIndex:function(e){k(e),n instanceof Z&&n.setPaletteIndex(e)},onChangeColor:function(e){var t=h.slice();t[p]=e,n instanceof Z&&n.updatePalette(t),Q(t)},handleQuantize:function(e){if(e=Math.floor(e),n instanceof J){if(window.confirm("(Don't panic!) Quantizing a bitmap will change it from mode 3 to mode 4. Is this okay?")){var t=Y(n,e),a=t.palette,r=t.sprite;z(r),Q(a)}}else alert("Requantization of paletted images currently not supported!")},settings:I,onSettingsChange:V}))))},Ne=(n(32),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function Se(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(i.a.createElement(ke,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/vocc",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/vocc","/service-worker.js");Ne?(!function(e,t){fetch(e).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Se(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Se(t,e)}))}}()}},[[21,1,2]]]);
//# sourceMappingURL=main.2faef990.chunk.js.map